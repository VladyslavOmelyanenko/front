---
import { urlFor } from "../lib/sanity.js";

const { value } = Astro.props;

// pull the asset object from the block
const asset = value?.asset;

// Sanity requires either _ref or _id
const ref = asset?._ref ?? asset?._id ?? null;

let src = "";
if (ref) {
  // This is the ONLY correct value to pass to urlFor
  src = urlFor({ _ref: ref }).width(1200).auto("format").url();
}

const alt = value?.alt || value?.caption || "";
---

{src && <img src={src} alt={alt} loading="lazy" />}
